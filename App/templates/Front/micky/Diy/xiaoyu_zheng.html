
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="ie-stand">
    <title>3DCITY-DIY-甜甜圈</title>
    <script>
        var currentUrl = window.location.href;
    </script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
        <meta name="renderer" content="ie-stand">
        <link href="/ignite/doge/css/diy_ddd_common.css" type="text/css" rel="stylesheet" />
        <link href="/ignite/doge/css/diy_tian.css" type="text/css" rel="stylesheet" />
        <link href="/ignite/doge/css/jquery-ui.min.css" type="text/css" rel="stylesheet" />
        <script src="/ignite/doge/js/ZBasic.js"></script>
        <script src="/ignite/doge/js/json2.js"></script>
        <script src="/ignite/doge/diy/seajs-2.3.0/dist/sea-debug.js" type="text/javascript"></script>
        <script src="/ignite/doge/js/jquery-1.11.2.min.js" type="text/javascript"></script>
        <script src="/ignite/doge/js/jquery-ui.min.js" type="text/javascript"></script>
        <script src="/ignite/doge/diy/config.js" type="text/javascript"></script>
        <script type="text/javascript" src="/ignite/doge/js/countUp.js"></script>
        </head>
        <body>
        <!--<script src="/ignite/doge/js/farbtastic/farbtastic.js" type="text/javascript"></script>-->
    <!--<link href="/ignite/doge/js/farbtastic/farbtastic.css" type="text/css" rel="stylesheet" />-->
<div id="editor">
        <form id="diyf" name="diyf" method="post" role="form" onSubmit="return false;">
        <div id="edt_preview" ></div>
    <div id="edt_control"
            >
        <p class="edt_prd_title">甜甜圈<span>DIY</span></p>
        <p class="edt_prd_desc">18K金（彩宝）耳钉</p>
        <p class="edt_prd_promotion"></p>
        <div class="edt_prd_price">
            <span class=" priceText">￥<span id="showprice"></span></span>
            <div class="edt_prd_like" id="zan" pid="32405"><i id="zannum">48</i></div>
        </div>
        <div class="edt_space"></div>
        <div id="edt_ctr">
            <div class="earring_diamond">
                <div class="earring_style">
                    <div class="earring_left earring_style_item" id="earring_inner_group" >
                        <span class="tit">内圈样式
                            <em class="remove-ring" id="remove_inner" unitid="143"></em>
                        </span>
                        <div class="pic edt_diamonds_pos" id="earring_inner" groupId="0" metal="128" unitId="143">
                            <div class="edt_pos_diamond" posnum="0" diamond="87" groupId="0"></div>
                            <input type="hidden" value="87" id="pos_0" name="earring_inner">
                            <input type="hidden" value="128" id="pos_material_0" name="earring_inner_material">
                            <input type="hidden" value="1" id="earring_inner_visiable" name="earring_inner_visiable">
                        </div>
                    </div>
                    <div class="earring_left" style="display:none" id="add_inner_group">
                        <span class="tit">添加内圈</span>
                        <div class="pic add-ring" id="add_inner"></div>
                    </div>
                        <div class="earring_left add_pic" ></div>
                        <div class="earring_left earring_style_item" id="earring_outer_group" >
                            <span class="tit">外圈样式
                                <em class="remove-ring" id="remove_outer" unitid="144"></em>
                            </span>
                            <div class="pic edt_diamonds_pos" id="earring_outer" groupId="1" metal="129" unitId="144">
                                <div class="edt_pos_diamond" posnum="0" diamond="88" groupId="1"></div>
                                <input type="hidden" value="88" id="pos_1" name="earring_outer">
                                <input type="hidden" value="129" id="pos_material_1" name="earring_outer_material">
                                <input type="hidden" value="1" id="earring_outer_visiable" name="earring_outer_visiable">
                            </div>
                        </div>
                            <div class="earring_left" style="display:none;" id="add_outer_group">
                                <span class="tit">添加外圈</span>
                                <div class="pic add-ring" id="add_outer"></div>
                            </div>
                    </div>

                <div class="splitLine">
                    <div class="arrow"></div>
                </div>
                <!-- <div id="part_selector_diamond" class="part_selector_item">
                    <div class="part_unit" id="part_unit_diamond">
                        <span class="unit_name">彩宝</span>
                        <div class="selected_icon diamond_common_red" id="diamondCurrentIcon"></div>
                        <span class="selected_name" id="diamondCurrentText">红宝石</span>
                        <div class="the-arrow-normal" id="the-arrow-diamond"></div>
                    </div>
                </div>
                <div id="edt_diamond_shop-g" class="edt_dropdown">
                    <div id="edt_diamond_shop" class="edt_list_select">
                        <div id="edt_diamond_shop_143">
                            <div class="edt_shop_diamond" diamond="85" diamondact="85" title="钻石" pos="143" dp="42.00">
                                <div class="diamond_common_white_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="86" diamondact="86" title="红宝石" pos="143" dp="23.00">
                                <div class="diamond_common_red_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="87" diamondact="87" title="蓝宝石" pos="143" dp="29.00">
                                <div class="diamond_common_blue_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="88" diamondact="88" title="粉蓝宝" pos="143" dp="18.00">
                                <div class="diamond_common_pink_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="89" diamondact="89" title="黄蓝宝" pos="143" dp="19.00">
                                <div class="diamond_common_yellow_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="90" diamondact="90" title="沙佛莱" pos="143" dp="13.00">
                                <div class="diamond_common_green_30"></div>
                            </div>
                        </div>
                        <div id="edt_diamond_shop_144">
                            <div class="edt_shop_diamond" diamond="86" diamondact="86" title="红宝石" pos="144" dp="23.00">
                                <div class="diamond_common_red_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="87" diamondact="87" title="蓝宝石" pos="144" dp="29.00">
                                <div class="diamond_common_blue_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="88" diamondact="88" title="粉蓝宝" pos="144" dp="18.00">
                                <div class="diamond_common_pink_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="89" diamondact="89" title="黄蓝宝" pos="144" dp="19.00">
                                <div class="diamond_common_yellow_30"></div>
                            </div>
                            <div class="edt_shop_diamond" diamond="90" diamondact="90" title="沙佛莱" pos="144" dp="13.00">
                                <div class="diamond_common_green_30"></div>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>

            <div>
                <input />
            </div>

            <div class="earring_metal">
                <!--<div><span class="tit">请选择材质</span></div>-->
                <div id="part_selector_metal" class="part_selector_item">
                    <div class="part_unit" id="part_unit_metal">
                        <span class="unit_name">材质</span>
                        <div class="selected_icon metal_gold_red" id="materialCurrentIcon"></div>
                        <span class="selected_name" id="materialCurrentText">18K黄金</span>
                        <div class="the-arrow-normal" id="the-arrow-metal"></div>
                    </div>
                    <div id="edt_ctr_metal_g">
                        <div id="edt_ctr_metal" class="edt_dropdown">
                            <div metal="18K_gold" class="edt_metal_c metal_gold_yellow" idx="130" title="18K黄金"></div>
                            <div metal="18K_white" class="edt_metal_c metal_gold_white" idx="129" title="18K白金"></div>
                            <div metal="18K_rosy" class="edt_metal_c metal_gold_red" idx="128" title="18K玫瑰金"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn_box">
            <button type="button" class="btn-buy btn-default arcbuynow"  id="web3dSaveBuy" data-loading-text="<span class='' aria-hidden='true' style='display:inline-block;float:left;height:45px;line-height:45px;padding:0 5px 0 0;'>
            <img src='/ignite/doge/imgs/jewelry/loading.gif' width='20' height='20'/></span>正在提交..." autocomplete="off">放入购物袋</button>
            <input type="hidden" value="" name="pid" id="pid"></p>
            <input type="hidden" value="" name="cover" id="cover">
            <input type="hidden" value="38" name="cid" id="cid">
            <input type="hidden" value="" name="price" id="price">
            <input type="hidden" value="0" id="stype" name="stype">

        </div>

        <div class="my_operation" id="my_operation">
            <a href="javascript:void(0);"  class="btn_save" id="web3dSave" >保存我的方案</a>
            <i></i>
            <!--<a href="javascript:;" class="btn_share">分享</a>-->
            <!-- JiaThis Button BEGIN -->
            <div class="" >
                <a href="http://www.jiathis.com/share?uid=2075231" class="jiathis  jiathis_separator jtico_jiathis" target="_blank">分 享</a>
            </div>
            <script type="text/javascript" >
                var jiathis_config={
                    data_track_clickback: true,
                    url:'http://localhost/ignite/index/diy-jewelryeditall-cid-38.html',
                    siteNum:5,
                    sm:"weixin,tsina,tqq,renren,kaixin001",
                    summary:"首饰也可以DIY啦！一起来3DCITY玩转3D打印和DIY首饰的乐趣...",
                    shortUrl:true,
                    hideMore:true
                }
            </script>
            <script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=2075231" charset="utf-8"></script>
            <!-- JiaThis Button END -->
        </div>

    </div>
        </form>
    </div>


<script type="text/javascript">
//    
    seajs.use(["3dcity/earrings/ZEntry.js", "common/ZPost.js", "common/gui/ZDDDPublic"], function(ZEntry, ZPost, ZDDDPublic) {
        var _parent = document.getElementById("edt_preview"), i;
        var dddPublic = new ZDDDPublic(_parent,0);

        // 手机端, 显示或者隐藏jquery元素
        
        // the default is active inner
        dddPublic.activePart2($('#earring_inner'));

        // bind each part click event
        $(".edt_diamonds_pos").each(function () {
            $(this).on("click", function (event) {
                dddPublic.activePart2($(this));

                                event.stopPropagation();
            });
        });


        var diamondPrice={"143":{"diamond_price":29,"diamond_num":"8","price":"418.00","visiable":1,"price_count":"2"},"144":{"diamond_price":18,"diamond_num":"16","price":"626.00","visiable":1,"price_count":"2"}};
        getprice(diamondPrice);
        visiableshow();

        // bind each diamond click event
        $(".edt_shop_diamond").each(function (){
            $(this).on("click", function (event) {
                // 关闭宝石列表面板
                
                dddPublic.activeDiamondBar($(this));
               //console.log(this);
                var pos = this.getAttribute('pos');
                var price=this.getAttribute('dp');
                diamondPrice[pos]['diamond_price']=price;
                getprice(diamondPrice);
                event.stopPropagation();
            });
        });

        function visiableshow(){
            if($("#earring_inner_group").is(':hidden')) {
                $("#add_inner_group").show();
                $("#remove_outer").hide();
            } else {
                $("#add_outer_group").hide();
                $("#remove_outer").show();
            }

            if($("#earring_outer_group").is(':hidden')) {
                $("#add_outer_group").show();
                $("#remove_inner").hide();
            }else{
                $("#add_outer_group").hide();
                $("#remove_inner").show();
            }
        }

        function getprice(priceArr){
            var price=0;
            for(key in priceArr){
                price =price + (parseInt(priceArr[key]['price']) + parseInt(priceArr[key]['diamond_price'])*parseInt(priceArr[key]['diamond_num']))*parseInt(priceArr[key]['visiable'])*parseInt(priceArr[key]['price_count']);
            }
            document.getElementById('price').value=price;
            var demo = new CountUp("showprice", 0, price, 2, 0.2);
            demo.start();
        }





        $("#part_unit_diamond").on("click", function (event) {
                        dddPublic.activeCom($("#edt_diamond_shop-g"), $("#the-arrow-diamond"));
            event.stopPropagation();
        });

        $("#part_unit_metal").on("click", function (event) {
                        dddPublic.activeCom($("#edt_ctr_metal"), $("#the-arrow-metal"));
            event.stopPropagation();
        });

        $(".edt_metal_c").each(function () {
            $(this).on("click", function (event) {
                // 关闭材质列表面板
                                dddPublic.activeMetalBar($(this));
                event.stopPropagation();
            });
        });

        $("#remove_inner").on("click", function(event) {
            $("#earring_inner_visiable").val(0);
            var pos=this.getAttribute("unitid");
            diamondPrice[pos]["visiable"]=0;
            getprice(diamondPrice);
            $("#earring_inner_group").hide();
            $("#add_inner_group").show();
            dddPublic.activePart2($('#earring_outer'));
            $("#remove_outer").hide();
            event.stopPropagation();
        });

        $("#add_inner").on("click", function(event) {
            $("#earring_inner_visiable").val(1);
            var pos=$("#remove_inner").attr("unitid");
            diamondPrice[pos]["visiable"]=1;
            getprice(diamondPrice);
            $("#add_inner_group").hide();
            $("#earring_inner_group").show();
            dddPublic.activePart2($('#earring_inner'));
            $("#remove_outer").show();
            event.stopPropagation();
        });


        $("#remove_outer").on("click", function(event) {
            $("#earring_outer_visiable").val(0);
            var pos=this.getAttribute("unitid");
            diamondPrice[pos]["visiable"]=0;
            getprice(diamondPrice);
            $("#earring_outer_group").hide();
            $("#add_outer_group").show();
            dddPublic.activePart2($('#earring_inner'));
            $("#remove_inner").hide();
            event.stopPropagation();
        });

        $("#add_outer").on("click", function(event) {
            $("#earring_outer_visiable").val(1);
            var pos=$("#remove_outer").attr("unitid");
            diamondPrice[pos]["visiable"]=1;
            getprice(diamondPrice);
            $("#add_outer_group").hide();
            $("#earring_outer_group").show();
            dddPublic.activePart2($('#earring_outer'));
            $("#remove_inner").show();
            event.stopPropagation();
        });

        


        $(function(){
            $("#zan").click(function(){
                var zan =$(this);
                var pid = zan.attr("pid"); //对应id
                zan.css("opacity",0);
                zan.animate({opacity:1});
                $.ajax({
                    type:"GET",
                    url:"/ignite/user.php/myzan/add/id/"+pid,
                    data:"",
                    cache:false, //不缓存此页面
                    success:function(data){
                        $('#zannum').html(data);
                    }
                });
                return false;
            });
        });
        var inParas = {
            projectName: "/ignite/doge/diy/assets/3dcity/projects/necklaces/05/05.project",
            projectName_nowebgl: "/ignite/doge/diy/assets/nowebgl/projects/necklaces/05/05.project",
            cameraMatrixArray : [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 20, 40, 1],
            rootPath: "/ignite",
            elementParent : _parent
        };
        var zEntry = new ZEntry(inParas);
        dddPublic.player3d = zEntry.player;
        var otherValue={ "camera_screen" : {
        "pos_x" : 0,
        "pos_y" : 8.755,
        "pos_z" : 9.771,
        "rot_x" : -50,
        "rot_y" : 0,
        "rot_z" : 0,
        "target_x" : 0,
        "target_y" : 0,
        "target_z" : 0,
        "width" : 512,
        "height" : 512
    }};
        dddPublic.player3d.screenShotParas = otherValue.camera_screen;
    });

    /*$(document).ready(function(){
        alert($(window).width());
    })*/
</script>

<!--<script src="js/nowebgl.js"></script>-->
</body>
</html>
