<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <meta charset="utf-8">
    <script>
        var currentUrl=window.location.href;
        <{if $mobileAgent !=3 }>
            if(currentUrl.indexOf("mmode-1") < 0 ) {
                reUrl = currentUrl.replace(".html", "");
                reUrl = reUrl + "-mmode-1.html";
                window.location.href = reUrl;
            }
        <{/if}>
    </script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<{if !$mmode}>
    <link href="__NEOSTATIC__/css/scojs.css" rel="stylesheet">
    <script src="__NEOSTATIC__/js/ZBasic.js"></script>
    <script src="__NEOSTATIC__/js/json2.js"></script>
    <script src="__NEOSTATIC__/diy/seajs-2.3.0/dist/sea.js" type="text/javascript"></script>
    <script src="__NEOSTATIC__/js/jquery-1.11.2.min.js" type="text/javascript"></script>
    <script src="__NEOSTATIC__/js/sco.panes.js"></script>
    <script src="__NEOSTATIC__/js/sco.tab.js"></script>
    <link href="__NEOSTATIC__/css/diy_ddd_common.css" type="text/css" rel="stylesheet"/>
    <{if $dataAll.diy_cate.cate_group eq 1}>
        <!--<link href="__NEOSTATIC__/css/diy_ddd_ring_common.css" type="text/css" rel="stylesheet"/>-->
    <{/if}>
    <link href="__NEOSTATIC__/css/<{$dataAll.diy_cate.idprefix}>" rel="stylesheet">
    <script src="__NEOSTATIC__/diy/config.js" type="text/javascript"></script>
    <script type="text/javascript" src="__NEOSTATIC__/js/countUp.js"></script>
    </head>
    <body>
<{else}>
    <!-------------第三版手机版------------------>
    <{if $mtype == 'iwx'}>
    <{include file=C('IWXHEADER_START') wxtitle="IGNITE - 3D城 | 珠宝首饰 | 设计师 | 极客 | DIY创意 | 3D打印" }>
    <link href="__MSTATIC__/css/diy_ddd_common.css" type="text/css" rel="stylesheet" />
    <script src="__NEOSTATIC__/js/ZBasic.js"></script>
    <script src="__NEOSTATIC__/diy/seajs-2.3.0/dist/sea.js"></script>
    <script src="__NEOSTATIC__/diy/config.js" type="text/javascript"></script>
    <script type="text/javascript" src="__NEOSTATIC__/js/countUp.js"></script>
    <link rel="stylesheet" type="text/css" href="__MSTATIC__/css/doge.mobile.css">
    <!--<link rel="stylesheet" type="text/css" href="__NEOSTATIC__/css/doge.diyediter.css">-->
    <link rel="stylesheet" href="__MICKYMOBILESTATIC__/new/css/bootstrap.min.css">
    <link rel="stylesheet" href="__MICKYMOBILESTATIC__/new/css/fonts.css">
    <link rel="stylesheet" href="__MICKYMOBILESTATIC__/new/css/top.css">
    <link rel="stylesheet" href="__MICKYMOBILESTATIC__/new/css/footer.css">
<style>
    .wy-logo{
        margin-top:11px;
    }
</style>
    <{include file=C('IWXHEADER_END')}>

    <{else}>
    <!---------------第二版手机版-------------------------->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <{include file=C('KITTYMDIYHEAD_START') wxtitle="IGNITE - 3D城 | 珠宝首饰 | 设计师 | 极客 | DIY创意 | 3D打印"}>
    <link href="__MSTATIC__/css/diy_ddd_common.css" type="text/css" rel="stylesheet" />
    <script src="__NEOSTATIC__/js/ZBasic.js"></script>
    <script src="__NEOSTATIC__/diy/seajs-2.3.0/dist/sea.js"></script>
    <script src="__NEOSTATIC__/diy/config.js" type="text/javascript"></script>
    <script type="text/javascript" src="__NEOSTATIC__/js/countUp.js"></script>
    </head>
    <body>
    <{include file=C('KITTYMDIYHEAD_END') wxtitle="IGNITE" ch="dft"}>
    <{/if}>
<{/if}>

<{if !$mmode}>
<div id="editor">
    <{if $showtype neq 1}>
    <form id="diyf" name="diyf" method="post" role="form" onSubmit="return false;">
    <{/if}>
    <div id="edt_preview"></div>
    <div id="edt_control"
        <{if $showtype eq 1}>
        style="display:none;"
        <{/if}>
    >
        <p class="edt_prd_title"><{$dataAll.diy_cate.cate_name}><span>DIY</span></p>

        <p class="edt_prd_desc"><{$dataAll.diy_cate.intro1}></p>


        <div class="edt_prd_price">
            <span class=" priceText">￥<span id="showprice"><{$udinfo.price}></span></span>
            <div class="edt_prd_like" id="zan" pid="<{$productInfo.p_id}>"><i id="zannum"><{$productInfo.p_zans}></i></div>

        </div>
        <div class="edt_space"></div>
        <div id="edt_ctr">
            <div class="earring_style">
                <div class="earring_style_item">
                    <span class="tit">请选择宝石</span>
                    <div class="edt_diamonds_pos" groupId="0" metal="128">
                        <{$i=0}>
                <{foreach $dataAll.diy_unit as $item}>
                    <{if $item.fieldtype eq 'DIAMOND'}>
                        <{if $dataAll.diy_cate.cid eq 40 or $dataAll.diy_cate.cid eq 39 }>
                            <{if $i==0 }>
                                <div class="edt_pos_diamond" pos="<{$item.id}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" unitid="<{$item.id}>">
                                    <div></div>
                                </div>
                            <{else}>
                                <div class="edt_pos_diamond" pos="<{$item.id}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" unitid="<{$item.id}>">
                                <div></div>
                                </div>
                            <{/if}>
                            <{section name=loop loop=$item.unit_diamond_count}>
                                <{$keyIndex=$smarty.section.loop.index+1}>
                                <{if $keyIndex < 10}><{$keyIndex="0"|cat:$keyIndex}><{/if}>
                                <{$posID_1=$item.unit_name|cat:"_"|cat:$keyIndex}>
                                <div class="edt_pos_diamond <{$item.unit_name}>" id="<{$posID_1}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" pos="<{$item.id}>">
                                    <div></div>
                                </div>
                            <{/section}>
                        <{else}>
                            <{section name=loop loop=$item.unit_diamond_count}>
                                <{$tempIndex=$smarty.section.loop.index+1}>
                                <{if $tempIndex < 10}><{$tempIndex="0"|cat:$tempIndex}><{/if}>
                                <{$posID=$item.unit_name|cat:"_"|cat:$tempIndex}>
                                <div class="edt_pos_diamond" id="<{$posID}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" pos="<{$item.id}>">
                                    <div></div>
                                </div>
                            <{/section}>

                        <{/if}>

                        <input type="hidden" value="<{$item.fieldvalue}>" id="pos_<{$item.diamondpos}>" name="<{$item.unit_name}>">
                        <{$i=$i+1}>
                        <{/if}>
                        <{/foreach}>
                    </div>
                </div>
                <div class="splitLine" style="margin-bottom: 18px;">
                    <div class="arrow" style="left: 47%"></div>
                </div>
                <div id="edt_diamond_shop" class="edt_list_select">
                    <{foreach from=$diamondinfo key=Id item=item}>
                    <div id="edt_diamond_shop_<{$Id}>">
                        <{foreach from=$item key=myId item=result}>
                        <div class="edt_shop_diamond" diamond="<{$result.styleDiamondValue}>" diamondact="<{$result.id}>" title="<{$result.dname}>" pos="<{$Id}>" dp="<{$result.price}>">
                            <div class="<{$result.style}>_30"></div>
                        </div>
                        <{/foreach}>
                    </div>
                    <{/foreach}>



                </div>
            </div>
            <div class="edt_space"></div>
            <{foreach $dataAll.diy_unit as $item}>
                <{if $item.fieldtype eq 'MATERIAL'}>
                    <div class="earring_metal">
                        <div><span class="tit">请选择材质与手寸</span></div>
                        <div id="part_selector_metal" class="part_selector_item">
                            <div class="part_unit" id="part_unit_metal">
                                <span class="unit_name">材质</span>
                                <div class="selected_icon" id="materialCurrentIcon"></div>
                                <span class="selected_name" id="materialCurrentText"><{$item.fieldvalue_name}></span>
                                <div class="the-arrow the-arrow-normal" id="the-arrow-metal"></div>
                            </div>
                            <{if $dataAll.diy_cate.cid eq 48 }>
                                <div id="edt_ctr_metal_g" class="edt_list_select">
                                    <div id="edt_ctr_metal" class="edt_dropdown">
                                        <div metal="18K_gold" class="edt_metal_c metal_gold_yellow" idx="130" title="18K黄金"></div>
                                        <div metal="18K_white" class="edt_metal_c metal_gold_white" idx="129" title="18K白金"></div>
                                        <div metal="18K_rosy" class="edt_metal_c metal_gold_red" idx="128" title="18K玫瑰金"></div>
                                        <input type="hidden" name="<{$item.unit_name}>" value="<{$item.fieldvalue}>" id="material">
                                    </div>
                                </div>
                            <{else}>
                                <div id="edt_ctr_metal_g_re">
                                    <div id="edt_ctr_metal_g" class="edt_dropdown">
                                        <div id="edt_ctr_metal">
                                            <div metal="18K_gold" class="edt_metal_c metal_gold_yellow" idx="130" title="18K黄金"></div>
                                            <div metal="18K_white" class="edt_metal_c metal_gold_white" idx="129" title="18K白金"></div>
                                            <div metal="18K_rosy" class="edt_metal_c metal_gold_red" idx="128" title="18K玫瑰金"></div>
                                            <input type="hidden" name="<{$item.unit_name}>" value="<{$item.fieldvalue}>" id="material">
                                        </div>
                                    </div>
                                </div>
                            <{/if}>
                        </div>
                    </div>
                <{elseif $item.fieldtype eq 'SELECT'}>
                    <div id="part_selector_size" class="part_selector_item">
                        <div class="part_unit" id="part_unit_size">
                            <span class="unit_name">手寸<{$result.value}></span>
                            <!--<div class="selected_icon" id="materialCurrentIcon"></div>-->
                            <span class="selected_name" id="sizeCurrentText"><{$item.fieldvalue_show}></span>
                            <input type="hidden" name="<{$item.unit_name}>" value="<{$item.fieldvalue}>" id="unit_size">
                            <div class="the-arrow the-arrow-normal" id="the-arrow-size"></div>
                        </div>
                        <div id="edt_ctr_size_g" class="">
                            <div id="edt_ctr_size" class="edt_dropdown">
                                <{foreach $item.unit_value_arr as $result}>
                                    <span class="ring_size" sizevalue="<{$result.key}>"><{$result.value}></span>
                                <{/foreach}>
                               <!-- <span class="ring_size">01</span>
                                <span class="ring_size">02</span>
                                <span class="ring_size">03</span>
                                <span class="ring_size">04</span>
                                <span class="ring_size">05</span>
                                <span class="ring_size">06</span>
                                <span class="ring_size">07</span>
                                <span class="ring_size">08</span>
                                <span class="ring_size">09</span>-->
                            </div>
                        </div>
                    </div>
                <{/if}>
            <{/foreach}>
        </div>
        <div class="btn_box">
            <button type="button" class="btn-buy btn-default arcbuynow"  id="web3dSaveBuy" data-loading-text="<span class='' aria-hidden='true' style='display:inline-block;float:left;height:45px;line-height:45px;padding:0 5px 0 0;'>
            <img src='__NEOSTATIC__/imgs/jewelry/loading.gif' width='20' height='20'/></span>正在提交..." autocomplete="off">放入购物袋</button>
            <input type="hidden" value="<{$udinfo.id}>" name="pid" id="pid"></p>
            <input type="hidden" value="<{$udinfo.cover}>" name="cover" id="cover">
            <input type="hidden" value="<{$dataAll.diy_cate.cid}>" name="cid" id="cid">
            <input type="hidden" value="<{$udinfo.price}>" name="price" id="price">
            <input type="hidden" value="0" id="stype" name="stype">
        </div>
        <div class="my_operation" id="my_operation">
            <a href="javascript:void(0);"  class="btn_save" id="web3dSave" >保存我的方案</a>
            <!--<i></i>-->
            <!--<a href="javascript:;" class="btn_share">分享</a>-->
            <!-- JiaThis Button BEGIN -->
           <!-- <div class="">
                <a href="http://www.jiathis.com/share?uid=2075231" class="jiathis  jiathis_separator jtico_jiathis" target="_blank">分 享</a>
            </div>-->
            <script type="text/javascript" >
                var jiathis_config={
                    data_track_clickback:true,
                    url:'<{$shareInfo.link}>',
                    siteNum:5,
                    sm:"weixin,tsina,tqq,renren,kaixin001",
                    summary:"首饰也可以DIY啦！一起来IGNITE玩转3D打印和DIY首饰的乐趣...",
                    shortUrl:true,
                    hideMore:true
                }
            </script>
            <script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=2075231" charset="utf-8"></script>
            <!-- JiaThis Button END -->
        </div>
    </div>
<{if $showtype neq 1}>
</form>
<{/if}>
</div>
<{else}>
<!--头部导航 start-->
<!--<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#globalnav">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="__DOC__/index.php/wx">
                <img src="__MSTATIC__/imgs/hlogo.png"/>
            </a>
            <p class="navbar-text titlecal"><{$dataAll.diy_cate.cate_name}></p>
        </div>
        <div class="collapse navbar-collapse" id="globalnav">
            <ul class="nav navbar-nav navbar-right usercal">
                <li class="home"><a href="__DOC__/index.php/wx"><span class="glyphicon glyphicon-home" aria-hidden="true"></span>首页</a></li>
                <li class="divider"></li>
                <li><a href="__DOC__/user.php/cart/index/mmode/1"><span class="glyphicon glyphicon-shopping-cart" aria-hidden="true"></span>购物车</a></li>
                <li class="dropdown person"><a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="glyphicon glyphicon-user" aria-hidden="true"></span>您<span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="__DOC__/user.php/wxuser/mycoupon">优惠券<span class="badge"></span></a></li>
                        <li><a href="__DOC__/user.php/wxuser/ordermanage/searchstatus/1">订单<span class="badge"></span></a></li>
                        <li><a href="__DOC__/user.php/wxuser/diylist">我的定制</a></li>
                        <li class="divider"></li>
                        <li><a href="__DOC__/user.php/wxuser/address">收件地址</a></li>
                        <li><a href="__DOC__/user.php/sms/changemob">修改手机绑定</a></li>
                    </ul>
                </li>
                <li><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDI1MjU3NA==&mid=202956603&idx=1&sn=b2a45f3b53d9595f9892b01daa0236fc#rd"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>关注3DCity</a></li>
                <li><a href="__DOC__/user.php/logout/?fromurl=2ba39205PTTLZXXk1DFgwWShVFTh8KUVcNFkwfAFZfG1wPBQNITENMHlxYXVIe"><span class="glyphicon glyphicon-off" aria-hidden="true"></span>注销</a></li>
            </ul>
        </div>
    </div>
</nav>-->

<!--头部导航 end-->
<!--DIY编辑器 start-->
<form id="diyf" name="diyf" method="post" role="form" onSubmit="return false;">
    <div id="editor">
        <div id="edt_preview"></div>
        <!--<div style="border-top: 1px solid #ccc"></div>-->
        <div id="edt_control">
            <!-- photo panel -->
            <div class="edt_style panel_photo" style="`display: block">
                <div class="panel_title">
                    <span class="title">请选择样式</span>
                    <!--<img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">-->
                </div>
                <div class="panel_content">
                    <div class="edt_pos_diamond_group_<{$dataAll.diy_cate.cid}>">
                        <div class="edt_diamonds_pos" groupId="0" metal="128">
    <{$i=0}>
    <{foreach $dataAll.diy_unit as $item}>
        <{if $item.fieldtype eq 'DIAMOND'}>
            <{if $dataAll.diy_cate.cid eq 40 or $dataAll.diy_cate.cid eq 39 }>
                <{if $i==0 }>
                <div class="edt_pos_diamond" pos="<{$item.id}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" unitid="<{$item.id}>">
                    <div></div>
                </div>
                <{else}>
                <div class="edt_pos_diamond" pos="<{$item.id}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" unitid="<{$item.id}>">
                    <div></div>
                </div>
                <{/if}>
            <{section name=loop loop=$item.unit_diamond_count}>
            <{$keyIndex=$smarty.section.loop.index+1}>
            <{if $keyIndex < 10}><{$keyIndex="0"|cat:$keyIndex}><{/if}>
            <{$posID_1=$item.unit_name|cat:"_"|cat:$keyIndex}>
                <div class="edt_pos_diamond <{$item.unit_name}>" id="<{$posID_1}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" pos="<{$item.id}>">
                    <div></div>
                </div>
            <{/section}>
        <{else}>
            <{section name=loop loop=$item.unit_diamond_count}>
            <{$tempIndex=$smarty.section.loop.index+1}>
            <{if $tempIndex < 10}><{$tempIndex="0"|cat:$tempIndex}><{/if}>
            <{$posID=$item.unit_name|cat:"_"|cat:$tempIndex}>
                <div class="edt_pos_diamond" id="<{$posID}>" posnum="<{$i}>" diamond="<{$item.fieldvalue_styleDiamondValue}>" groupid="0" pos="<{$item.id}>">
                    <div></div>
                </div>
            <{/section}>
        <{/if}>
                <input type="hidden" value="<{$item.fieldvalue}>" id="pos_<{$item.diamondpos}>" name="<{$item.unit_name}>">
        <{$i=$i+1}>
        <{/if}>
    <{/foreach}>
                        </div>
                    </div>
                </div>
            </div>

            <!-- label panel -->
            <div class="edt_style panel_label" style="display: none">
                <div class="panel_title">
                    <span class="title">请选择样式</span>
                    <img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">
                </div>
                <div class="panel_content">
                    <{foreach $dataAll.diy_unit as $item}>
                    <{if $item.fieldtype eq 'DIAMOND'}>
                    <div class="part_selector_item part_item_diamond" unitid="<{$item.id}>" id="part_unit_diamond_<{$item.id}>"
                    <{if $item.ishidden eq 1}>
                    style="display: none"
                    <{/if}>
                    >
                    <div class="unit_name_parent left">
                        <div class="unit_name_center">彩宝</div>
                    </div>
                    <div class="unit_spite"></div>
                    <div class="selected_icon" id="diamondCurrentIcon"></div>
                    <div class="unit_name_parent right">
                        <div class="unit_name_center" id="diamondCurrentText">红宝石</div>
                    </div>
                    <div class="the-arrow-parent">
                        <div class="the-arrow" id="the-arrow-diamond"></div>
                    </div>
                </div>
                <div class="unit_space"></div>
                <{/if}>
                <{if $item.fieldtype eq 'MATERIAL'}>
                <div class="part_selector_item" id="part_unit_metal">
                    <div class="unit_name_parent left">
                        <div class="unit_name_center">材质</div>
                    </div>
                    <div class="unit_spite"></div>
                    <div class="selected_icon" id="materialCurrentIcon"></div>
                    <div class="unit_name_parent right">
                        <div class="unit_name_center" id="materialCurrentText">18K黄金</div>
                        <input type="hidden" name="Material" value="<{$item.fieldvalue}>" id="material">
                    </div>
                    <div class="the-arrow-parent">
                        <div class="the-arrow" id="the-arrow-metal"></div>
                    </div>
                </div>
                <div class="unit_space"></div>
                <{/if}>
                <{if $item.fieldtype eq 'PENDANT'}>
                <div class="part_selector_item" id="part_unit_style">
                    <div class="unit_name_parent left">
                        <div class="unit_name_center">款式</div>
                    </div>
                    <div class="unit_spite"></div>
                    <div class="selected_icon" id="styleCurrentIcon"></div>
                    <div class="unit_name_parent right">
                        <div class="unit_name_center" id="styleCurrentText">心形</div>
                        <input type="hidden" value="<{$item.fieldvalue}>" id="<{$item.unit_name}>" stylePendant="<{$item.fieldvalue_stylePendantValue}>" name="<{$item.unit_name}>">
                    </div>
                    <div class="the-arrow-parent">
                        <div class="the-arrow" id="the-arrow-style"></div>
                    </div>
                </div>
                <div class="unit_space"></div>
                <{/if}>
                <{if $item.fieldtype eq 'SELECT'}>
                <div class="part_selector_item" id="part_unit_size">
                    <div class="unit_name_parent left">
                        <div class="unit_name_center">手寸</div>
                        <input type="hidden" name="<{$item.unit_name}>" value="<{$item.fieldvalue}>" id="unit_size">
                    </div>
                    <div class="unit_spite"></div>

                    <div class="unit_name_parent_t">
                        <div class="unit_name_center_t" id="sizeCurrentText">5# / 45mm</div>
                    </div>
                    <div class="the-arrow-parent">
                        <div class="the-arrow" id="the-arrow-size"></div>
                    </div>
                </div>
                <div class="unit_space"></div>
                <{/if}>
                <{/foreach}>
            </div>
        </div>


        <!-- diamond shop panel -->
        <div class="edt_style panel_diamond_shop" style="display: none">
            <div class="panel_title">
                <span class="title">请选择宝石</span>
                <img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">
            </div>
            <div class="panel_content edt_list_select">
                <{foreach from=$diamondinfo key=Id item=item}>
                <div class="panel_diamond_item" id="edt_diamond_shop_<{$Id}>">
                    <{foreach from=$item key=myId item=result}>
                    <div class="edt_shop_diamond" diamond="<{$result.styleDiamondValue}>" diamondact="<{$result.id}>" title="<{$result.dname}>" pos="<{$Id}>" dp="<{$result.price}>">
                        <div class="diamond_item_image <{$result.style}>"></div>
                        <div class="diamond_item_space">&nbsp;</div>
                        <div class="diamond_item_title_parent">
                            <span class="diamond_item_title"><{$result.dname}></span>
                        </div>
                    </div>
                    <{/foreach}>
                </div>
                <{/foreach}>
            </div>
        </div>

        <{foreach $dataAll.diy_unit as $item}>
        <!-- material shop panel -->
        <{if $item.fieldtype eq 'MATERIAL'}>
        <div class="edt_style panel_metal_shop" style="display: none">
            <div class="panel_title">
                <span class="title">请选择材质</span>
                <img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">
            </div>
            <div class="panel_content">
                <div class="edt_metal_c" idx="129" title="18K白金">
                    <div class="metal_item_image metal_gold_white"></div>
                    <div class="metal_item_space">&nbsp;</div>
                    <div class="metal_item_title_parent">
                        <span class="metal_item_title">18K白金</span>
                    </div>
                </div>
                <div class="edt_metal_c" idx="128" title="18K玫瑰金">
                    <div class="metal_item_image metal_gold_red"></div>
                    <div class="metal_item_space">&nbsp;</div>
                    <div class="metal_item_title_parent">
                        <span class="metal_item_title">18K玫瑰金</span>
                    </div>
                </div>
                <div class="edt_metal_c" idx="130" title="18K黄金">
                    <div class="metal_item_image metal_gold_yellow"></div>
                    <div class="metal_item_space">&nbsp;</div>
                    <div class="metal_item_title_parent">
                        <span class="metal_item_title">18k黄金</span>
                    </div>
                </div>
            </div>
        </div>
        <{/if}>
        <!-- style shop panel -->
        <{if $item.fieldtype eq 'PENDANT'}>
        <div class="edt_style panel_style_shop" style="display: none">
            <div class="panel_title">
                <span class="title">请选择形状</span>
                <img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">
            </div>

            <div class="panel_content">
                <{foreach from=$dataAll['pendant'][$item.id] key=Id item=res}>
                <div class="edt_pendant_style" idx="<{$Id}>" title="<{$res['dname']}>" pvalue="<{$res['id']}>" pos="<{$item.id}>" dp="<{$res.price}>">
                    <div class="style_item_image <{$res['style']}>"></div>
                    <div class="style_item_space">&nbsp;</div>
                    <div class="style_item_title_parent">
                        <span class="style_item_title"><{$res['dname']}></span>
                    </div>
                </div>
                <{/foreach}>
            </div>
        </div>
        <{/if}>
        <!-- size shop panel -->
        <{if $item.fieldtype eq 'SELECT'}>
        <div class="edt_style panel_size_shop" style="display: none">
            <div class="panel_title">
                <span class="title">请选择手寸</span>
                <img class="panel_back" src="__MSTATIC__/imgs/diy_ddd_common/back.png" alt="">
            </div>
            <div class="panel_content">
                <div class="edt_pendant_size">
                    <span class="ring_size" sizevalue="44">4# / 44mm</span>
                    <span class="ring_size" sizevalue="45">5# / 45mm</span>
                    <span class="ring_size" sizevalue="46">6# / 46mm</span>
                    <span class="ring_size" sizevalue="47">7# / 47mm</span>
                    <span class="ring_size" sizevalue="48">8# / 48mm</span>
                    <span class="ring_size" sizevalue="49">9# / 49mm</span>
                    <span class="ring_size" sizevalue="50">10# / 50mm</span>
                    <span class="ring_size" sizevalue="51">11# / 51mm</span>
                    <span class="ring_size" sizevalue="52">12# / 52mm</span>
                    <span class="ring_size" sizevalue="53">13# / 53mm</span>
                    <span class="ring_size" sizevalue="54">14# / 54mm</span>
                    <span class="ring_size" sizevalue="55">15# / 55mm</span>
                    <span class="ring_size" sizevalue="56">16# / 56mm</span>
                    <span class="ring_size" sizevalue="57">17# / 57mm</span>
                    <span class="ring_size" sizevalue="58">18# / 58mm</span>
                    <span class="ring_size" sizevalue="59">19# / 59mm</span>
                    <span class="ring_size" sizevalue="60">20# / 60mm</span>
                    <span class="ring_size" sizevalue="61">21# / 61mm</span>
                    <span class="ring_size" sizevalue="62">22# / 62mm</span>
                    <span class="ring_size" sizevalue="63">23# / 63mm</span>
                    <span class="ring_size" sizevalue="64">24# / 64mm</span>
                    <span class="ring_size" sizevalue="65">25# / 65mm</span>
                    <span class="ring_size" sizevalue="66">26# / 66mm</span>
                    <span class="ring_size" sizevalue="67">27# / 67mm</span>
                    <span class="ring_size" sizevalue="68">28# / 68mm</span>
                    <span class="ring_size" sizevalue="69">29# / 69mm</span>
                    <span class="ring_size" sizevalue="70">30# / 70mm</span>
                    <span class="ring_size" sizevalue="71">31# / 71mm</span>
                    <span class="ring_size" sizevalue="72">32# / 72mm</span>
                    <span class="ring_size" sizevalue="73">33# / 73mm</span>
                    <span class="ring_size" sizevalue="74">34# / 74mm</span>
                    <span class="ring_size" sizevalue="75">35# / 75mm</span>
                    <span class="ring_size" sizevalue="76">36# / 76mm</span>
                </div>
            </div>
        </div>
        <{/if}>
        <{/foreach}>
    </div>
    </div>
    <input type="hidden" value="<{$udinfo.id}>" name="pid" id="pid">
    <input type="hidden" value="<{$udinfo.cover}>" name="cover" id="cover">
    <input type="hidden" value="<{$dataAll.diy_cate.cid}>" name="cid" id="cid">
    <input type="hidden" value="<{$udinfo.price}>" name="price" id="price">
    <input type="hidden" value="0" id="stype" name="stype">
    <input type="hidden" value="<{$mmode}>" id="mmode" name="mmode">
    <input type="hidden" value="<{$mtype}>" id="mtype" name="mtype">
    <!--DIY编辑器 end-->
    <!--底部价格 start-->
    <div class="arcbar buildit">
        <label class="price">价格: <span class="price-cost">￥<span id="showprice"></span></span></label>
        <button type="button" class="btn btn-default arcbuynow"  id="web3dSaveBuy" data-loading-text="<span class='' aria-hidden='true' style='display:inline-block;float:left;height:45px;line-height:45px;padding:0 5px 0 0;'><img src='__NEOSTATIC__/imgs/jewelry/loading.gif' width='20' height='20'/></span>正在提交..." autocomplete="off">立即购买</button>
    </div>
    <!--底部价格 end-->
</form>
<{/if}>
<{if $dataAll.diy_cate.cid eq 40}>
    <{$projNum=2}>
<{else}>
    <{$projNum=1}>
<{/if}>
<script type="text/javascript">

    seajs.use(["3dcity/earrings/ZEntry.js", "common/gui/ZDDDPublic"], function (ZEntry, ZDDDPublic) {

        $('.edt_diamonds_pos').attr('metal',$('#material').val());

        var _parent = document.getElementById("edt_preview"), i = 0;

        var dddPublic = new ZDDDPublic(_parent, <{$mmode}>);

        dddPublic.activePart1($('.edt_diamonds_pos'), false);
        var diamondPrice=<{$diamondPriceJson}>;
       getprice(diamondPrice);

        <{if $dataAll.diy_cate.cid eq 48 or $dataAll.diy_cate.cid eq 49}>
            // Set arrow position
            var arrow_start_offset = 90;
            var setArrowOffset = function(offset) {
                $(".arrow").animate({left : offset});
            };
            setArrowOffset(arrow_start_offset);
            $(".edt_pos_diamond").each(function () {
                $(this).bind("click", function() {
                    setArrowOffset(arrow_start_offset + parseInt($(this).attr("posnum")) * arrow_start_offset);
                });
            });
        <{/if}>

        <{if $dataAll.diy_cate.cid eq 50 and $mmode eq 1}>
            $(".panel_photo").hide();
            $(".panel_label").show();
            $(".panel_label .panel_back").hide();
            $(".edt_pos_diamond").click();
        <{/if}>

        $(".edt_shop_diamond").each(function () {
            $(this).on("click", function(event) {
                // 关闭宝石列表面板
                <{if $mmode}>
                    dddPublic.jqueryElementStatus($(".panel_diamond_shop"), false);
                    dddPublic.activeDiamondBarMobileDown($(this));
                <{else}>
                    dddPublic.activeDiamondBarDown($(this));
                <{/if}>

                var pos = this.getAttribute('pos');
                var price=this.getAttribute('dp');
                diamondPrice[pos]['diamond_price']=price;
                getprice(diamondPrice);
                event.stopPropagation();
            });
        });

        <{if $mmode}>
        $(".part_item_diamond").each(function () {
            $(this).on("click", function(event) {
                dddPublic.jqueryElementStatus($(".panel_diamond_shop"), true);
            });
        });
        <{/if}>

        $("#part_unit_metal").on("click", function (event) {
            <{if $mmode}>
                dddPublic.jqueryElementStatus($(".panel_metal_shop"), true);
            <{/if}>
            <{if $dataAll.diy_cate.cid neq 48}>
                dddPublic.activeCom($("#edt_ctr_metal_g"), $("#the-arrow-metal"));
            <{else}>
                dddPublic.activeCom($("#edt_ctr_metal"), $("#the-arrow-metal"));
            <{/if}>
            event.stopPropagation();

        });

        $(".edt_metal_c").each(function () {
            $(this).on("click", function (event) {
                <{if $mmode}>
                    dddPublic.jqueryElementStatus($(".panel_metal_shop"), false);
                <{/if}>
                dddPublic.activeMetalBar($(this));
                var currentMaterial=this.getAttribute('idx');
                $('#material').val(currentMaterial);
                event.stopPropagation();
            });
        });

        <{if $mmode}>
            $(".panel_cancel, .panel_back").each(function() {
                $(this).on("click", function() {
                    dddPublic.jqueryElementStatus($(this).parent(".panel_title").parent(), false);
                });
            });
        <{/if}>

        function getprice(priceArr){
            //console.log(priceArr);
            var price=0;
            for(key in priceArr){
                price = price + (parseInt(priceArr[key]['price']) + parseInt(priceArr[key]['diamond_price']) * parseInt(priceArr[key]['diamond_num']))*parseInt(priceArr[key]['visiable'])*parseInt(priceArr[key]['price_count']);
            }
           //document.getElementById('showprice').innerHTML=price;
            document.getElementById('price').value=price;
            var demo = new CountUp("showprice", 0, price, 2, 0.5);
            demo.start();
        }


        $("#part_unit_size").on("click", function (event) {
            <{if $mmode}>
                dddPublic.jqueryElementStatus($(".panel_size_shop"), true);
            <{/if}>
            dddPublic.activeCom($("#edt_ctr_size"), $("#the-arrow-size"));
            event.stopPropagation();
        });
        $(".ring_size").each(function() {
            $(this).on("click", function (event) {
                <{if $mmode}>
                    dddPublic.jqueryElementStatus($(".panel_size_shop"), false);
                <{/if}>
                $("#sizeCurrentText").html($(this).html());
                var sizevalue=$(this).attr("sizevalue");
                $("#unit_size").val(sizevalue);
                event.stopPropagation();
            });
        });
        var inParas = {
            projectName: "__DOC__<{$dataAll.diy_cate.jspath}>",
            projectName_nowebgl: "__DOC__<{$dataAll.diy_cate.jspath_nowebgl}>",
            <{if $dataAll.diy_cate.cameramatrix}>
                cameraMatrixArray :   <{$dataAll.diy_cate.cameramatrix}>,
            <{/if}>
            rootPath: "__DOC__",
            elementParent : _parent
        };
        var zEntry = new ZEntry(inParas);
        dddPublic.player3d = zEntry.player;
        var otherValue=<{$dataAll.diy_cate.other_value}>;
        dddPublic.player3d.screenShotParas = otherValue.camera_screen;
    });

            $(function(){
                $("#zan").click(function(){
                    var zan =$(this);
                    var pid = zan.attr("pid"); //对应id
                    zan.css("opacity",0);
                    zan.animate({opacity:1});
                    $.ajax({
                        type:"GET",
                        url:"__USERIDX__/myzan/add/id/"+pid,
                        data:"",
                        cache:false, //不缓存此页面
                        success:function(data){
                            $('#zannum').html(data);
                        }
                    });
                    return false;
                });
            });
</script>
<script>
    wx.config({
        debug: false,
        appId: '<{$signPackage["appId"]}>',
        timestamp: '<{$signPackage["timestamp"]}>',
        nonceStr: '<{$signPackage["nonceStr"]}>',
        signature: '<{$signPackage["signature"]}>',
        jsApiList: [
            // 所有要调用的 API 都要加到这个列表中
            'onMenuShareTimeline',
            'onMenuShareAppMessage',
            'onMenuShareQQ',
            'onMenuShareWeibo'
        ]
    });
    wx.ready(function () {
        var tle = '<{$shareInfo.title}>';
        var dsc = '<{$shareInfo.desc}>';
        var lnk = '<{$shareInfo.link}>';
        var png = '<{$shareInfo.imgUrl}>';
        wx.onMenuShareAppMessage({
            title: tle,
            desc: dsc,
            link: lnk,
            imgUrl: png,
            trigger: function (res) {
                // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                //alert('用户点击发送给朋友');
            },
            success: function (res) {
                //window.location.href = "__URL__/sharetowx/s/<{$salt}>";
                alert('已分享');
            },
            cancel: function (res) {
                alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
        // 在这里调用 API
        wx.onMenuShareTimeline({ //分享到朋友圈
            title: dsc,
            link: lnk,
            imgUrl: png,
            trigger: function (res) {
                // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                //alert('用户点击分享到朋友圈');
            },
            success: function (res) {
                //window.location.href = "__URL__/sharetowx/s/<{$salt}>";
                alert('已分享');
            },
            cancel: function (res) {
                alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
        //alert('已注册获取“分享到朋友圈”状态事件');
        wx.onMenuShareQQ({
            title: tle,
            desc: dsc,
            link: lnk,
            imgUrl: png,
            trigger: function (res) {
                //alert('用户点击分享到QQ');
            },
            complete: function (res) {
                alert(JSON.stringify(res));
            },
            success: function (res) {
                //window.location.href = "__URL__/sharetowx/s/<{$salt}>";
                alert('已分享');
            },
            cancel: function (res) {
                alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
        //alert('已注册获取“分享到 QQ”状态事件');
        wx.onMenuShareWeibo({
            title: tle,
            desc: dsc,
            link: lnk,
            imgUrl: png,
            trigger: function (res) {
                //alert('用户点击分享到微博');
            },
            complete: function (res) {
                alert(JSON.stringify(res));
            },
            success: function (res) {
                //window.location.href = "__URL__/sharetowx/s/<{$salt}>";
                alert('已分享');
            },
            cancel: function (res) {
                alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
    });
</script>
</body>
</html>